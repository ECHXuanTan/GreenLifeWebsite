{"ast":null,"code":"import _toConsumableArray from\"D:/TMDT/GreenLifeWebsite/fe/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"D:/TMDT/GreenLifeWebsite/fe/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/TMDT/GreenLifeWebsite/fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/TMDT/GreenLifeWebsite/fe/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"D:/TMDT/GreenLifeWebsite/fe/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useEffect,useReducer}from'react';import Chart from'react-google-charts';import axios from'axios';import{Store}from'../store';import{getError}from'../utils';import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Card from'react-bootstrap/Card';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{summary:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};export default function DashboardScreen(){var _useReducer=useReducer(reducer,{loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,summary=_useReducer2$.summary,error=_useReducer2$.error,dispatch=_useReducer2[1];var _useContext=useContext(Store),state=_useContext.state;var userInfo=state.userInfo;useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('/api/orders/summary',{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});case 3:_yield$axios$get=_context.sent;data=_yield$axios$get.data;dispatch({type:'FETCH_SUCCESS',payload:data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[userInfo]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"B\\u1EA3ng \\u0111i\\u1EC1u khi\\u1EC3n\"}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:summary.users&&summary.users[0]?summary.users[0].numUsers:0}),/*#__PURE__*/_jsx(Card.Text,{children:\" T\\xE0i kho\\u1EA3n\"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsx(Card.Title,{children:summary.orders&&summary.users[0]?summary.orders[0].numOrders:0}),/*#__PURE__*/_jsx(Card.Text,{children:\" \\u0110\\u01A1n h\\xE0ng\"})]})})}),/*#__PURE__*/_jsx(Col,{md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(Card.Body,{children:[/*#__PURE__*/_jsxs(Card.Title,{children:[summary.orders&&summary.users[0]?summary.orders[0].totalSales.toFixed(2):0,\"\\u0111\"]}),/*#__PURE__*/_jsx(Card.Text,{children:\" Doanh thu\"})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Doanh s\\u1ED1\"}),summary.dailyOrders.length===0?/*#__PURE__*/_jsx(MessageBox,{children:\"Kh\\xF4ng c\\xF3 doanh s\\u1ED1\"}):/*#__PURE__*/_jsx(Chart,{width:\"100%\",height:\"400px\",chartType:\"AreaChart\",loader:/*#__PURE__*/_jsx(\"div\",{children:\"Loading Chart...\"}),data:[['Date','Doanh số']].concat(_toConsumableArray(summary.dailyOrders.map(function(x){return[x._id,x.sales];})))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"my-3\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Danh m\\u1EE5c s\\u1EA3n ph\\u1EA9m\"}),summary.productCategories.length===0?/*#__PURE__*/_jsx(MessageBox,{children:\"Kh\\xF4ng c\\xF3 danh m\\u1EE5c\"}):/*#__PURE__*/_jsx(Chart,{width:\"100%\",height:\"400px\",chartType:\"PieChart\",loader:/*#__PURE__*/_jsx(\"div\",{children:\"Loading Chart...\"}),data:[['Category','Products']].concat(_toConsumableArray(summary.productCategories.map(function(x){return[x._id,x.count];})))})]})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useReducer","Chart","axios","Store","getError","LoadingBox","MessageBox","Row","Col","Card","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","reducer","state","action","type","_objectSpread","loading","summary","payload","error","DashboardScreen","_useReducer","_useReducer2","_slicedToArray","_useReducer2$","dispatch","_useContext","userInfo","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axios$get","data","wrap","_callee$","_context","prev","next","get","headers","Authorization","concat","token","sent","t0","stop","apply","arguments","children","variant","md","Body","Title","users","numUsers","Text","orders","numOrders","totalSales","toFixed","className","dailyOrders","length","width","height","chartType","loader","_toConsumableArray","map","x","_id","sales","productCategories","count"],"sources":["D:/TMDT/GreenLifeWebsite/fe/src/screens/DashboardScreen.js"],"sourcesContent":["import React, { useContext, useEffect, useReducer } from 'react';\r\nimport Chart from 'react-google-charts';\r\nimport axios from 'axios';\r\nimport { Store } from '../store';\r\nimport { getError } from '../utils';\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Card from 'react-bootstrap/Card';\r\n\r\nconst reducer = (state, action) => {\r\n    switch (action.type) {\r\n      case 'FETCH_REQUEST':\r\n        return { ...state, loading: true };\r\n      case 'FETCH_SUCCESS':\r\n        return {\r\n          ...state,\r\n          summary: action.payload,\r\n          loading: false,\r\n        };\r\n      case 'FETCH_FAIL':\r\n        return { ...state, loading: false, error: action.payload };\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n\r\nexport default function DashboardScreen() {\r\n    const [{ loading, summary, error }, dispatch] = useReducer(reducer, {\r\n        loading: true,\r\n        error: '',\r\n      });\r\n      const { state } = useContext(Store);\r\n      const { userInfo } = state;\r\n    \r\n      useEffect(() => {\r\n        const fetchData = async () => {\r\n          try {\r\n            const { data } = await axios.get('/api/orders/summary', {\r\n              headers: { Authorization: `Bearer ${userInfo.token}` },\r\n            });\r\n            dispatch({ type: 'FETCH_SUCCESS', payload: data });\r\n          } catch (err) {\r\n            dispatch({\r\n              type: 'FETCH_FAIL',\r\n              payload: getError(err),\r\n            });\r\n          }\r\n        };\r\n        fetchData();\r\n      }, [userInfo]);\r\n    \r\n      return (\r\n        <div>\r\n          <h1>Bảng điều khiển</h1>\r\n          {loading ? (\r\n            <LoadingBox />\r\n          ) : error ? (\r\n            <MessageBox variant=\"danger\">{error}</MessageBox>\r\n          ) : (\r\n            <>\r\n              <Row>\r\n                <Col md={4}>\r\n                  <Card>\r\n                    <Card.Body>\r\n                      <Card.Title>\r\n                        {summary.users && summary.users[0]\r\n                          ? summary.users[0].numUsers\r\n                          : 0}\r\n                      </Card.Title>\r\n                      <Card.Text> Tài khoản</Card.Text>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <Card>\r\n                    <Card.Body>\r\n                      <Card.Title>\r\n                        {summary.orders && summary.users[0]\r\n                          ? summary.orders[0].numOrders\r\n                          : 0}\r\n                      </Card.Title>\r\n                      <Card.Text> Đơn hàng</Card.Text>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n                <Col md={4}>\r\n                  <Card>\r\n                    <Card.Body>\r\n                      <Card.Title>\r\n                        \r\n                        {summary.orders && summary.users[0]\r\n                          ? summary.orders[0].totalSales.toFixed(2)\r\n                          : 0}đ\r\n                      </Card.Title>\r\n                      <Card.Text> Doanh thu</Card.Text>\r\n                    </Card.Body>\r\n                  </Card>\r\n                </Col>\r\n              </Row>\r\n              <div className=\"my-3\">\r\n                <h2>Doanh số</h2>\r\n                {summary.dailyOrders.length === 0 ? (\r\n                  <MessageBox>Không có doanh số</MessageBox>\r\n                ) : (\r\n                  <Chart\r\n                    width=\"100%\"\r\n                    height=\"400px\"\r\n                    chartType=\"AreaChart\"\r\n                    loader={<div>Loading Chart...</div>}\r\n                    data={[\r\n                      ['Date', 'Doanh số'],\r\n                      ...summary.dailyOrders.map((x) => [x._id, x.sales]),\r\n                    ]}\r\n                  ></Chart>\r\n                )}\r\n              </div>\r\n              <div className=\"my-3\">\r\n                <h2>Danh mục sản phẩm</h2>\r\n                {summary.productCategories.length === 0 ? (\r\n                  <MessageBox>Không có danh mục</MessageBox>\r\n                ) : (\r\n                  <Chart\r\n                    width=\"100%\"\r\n                    height=\"400px\"\r\n                    chartType=\"PieChart\"\r\n                    loader={<div>Loading Chart...</div>}\r\n                    data={[\r\n                      ['Category', 'Products'],\r\n                      ...summary.productCategories.map((x) => [x._id, x.count,]),\r\n                    ]}\r\n                  ></Chart>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}